<!doctype html>
<html class="no-js">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ad-Hockery - Jerry: a jQuery like API for DOM parsing</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/Icon.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/Icon@2x.png">
    <link rel="stylesheet" href="/stylesheets/adhockery.css">
    <link rel="stylesheet" href="/stylesheets/prism.css">
    <script src="/javascripts/modernizr.custom.js"></script>
    <script src="//use.edgefonts.net/ultra;league-gothic.js"></script>
  </head>
  <body>

    <header>
      <h1 class="logo"><a href="/">Ad-Hockery</a></h1>
      <dl class="strapline">
        <dt>ad-hockery: <em>/ad·hok'@r·ee/</em>, n.</dt>
        <dd>Gratuitous assumptions... which lead to the appearance of semi-intelligent behavior but are in fact entirely arbitrary. <cite><a href="http://www.retrologic.com/jargon/A/ad-hockery.html">Jargon File</a></cite>
      </dl>
    </header>

    <div class="container">
      <main>
          <article>
    <header>
      <time datetime="2012-10-28T14:36:00">Oct 28 2012</time>
      <h1>Jerry: a jQuery like API for DOM parsing</h1>
    </header>
    <div class="paragraph">
<p>When unit testing things that produce HTML output (such as some Grails taglibs) there are some common pitfalls. Comparing large chunks of markup with an expected string is very brittle; whitespace and attribute ordering becomes significant. Often people end up using regular expressions or assertions like <code>assert output.contains('&lt;div id="foo"&gt;')</code>. Whilst it may be a bit more maintainable this doesn&#8217;t really test correct DOM structure which is often important and again, attribute order can be a problem.</p>
</div>

<div class="paragraph">
<p>Ideally making assertions against a parsed DOM would be the best solution but JVM libraries have usually been designed more for XML than HTML. Since nobody in their right mind is still using XHTML in 2012 the parser needs to be capable of coping with unclosed tags, value-less boolean attributes, etc.</p>
</div>
<div class="paragraph">
<p>I&#8217;ve been using <a href="http://jodd.org/doc/jerry/index.html">Jerry</a> for some time for this kind of testing and it&#8217;s pretty great. The API is derived from jQuery so there&#8217;s virtually no learning curve. Instead of complex string matching you can write neat specs like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="groovy language-groovy">void 'creates an input of the correct type'() {
    given:
    def markup = applyTemplate('&lt;my:searchFormTag/&gt;')

    expect:
    def dom = Jerry.jerry(markup)
    dom.find('form').hasClass('search-form')
    dom.find('form input').attr('type') == 'search'
    dom.find('form button').text() == 'Go'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For an even more jQuery like feel use Groovy&#8217;s import aliasing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="groovy language-groovy">import static jodd.jerry.Jerry.jerry as $</code></pre>
</div>
</div>
<div class="paragraph">
<p>To add Jerry to your project just include <code>'org.jodd:jodd-lagarto:3.4.0'</code> as a test dependency.</p>
</div>
    <footer>
      <ul class="tag-list">
          <li><a href="/tags/jerry/">jerry</a></li>
          <li><a href="/tags/java/">java</a></li>
          <li><a href="/tags/testing/">testing</a></li>
      </ul>
    </footer>
  </article>

      </main>

      <footer>
        <nav>
          <a href="/">Home</a>
          <a href="/about">About</a>
          <a href="/archive">Archive</a>
        </nav>
      </footer>
    </div>

    <script src="/javascripts/adhockery.js"></script>
    <script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-27275689-1', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>

<footer class="disqus">
  <div id="disqus_thread"></div>
            <script type="text/javascript">
            //<![CDATA[
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//adhockery.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            //]]>
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </script>
</footer>
