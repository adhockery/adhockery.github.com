---
title: Closures and field visibility
date: 2014-07-16 15:58 BST
tags:
published: false
---

I find Groovy Closures can sometimes behave in ways that, once I think about it, make perfect sense but initially seem surprising. One example of this is the fact that closures _declared in a parent class_ cannot “see” private fields of that class when run in the context of a child class.

READMORE

Take a look at this code

[source,groovy]
----
class Multiplier {

  private int multiplier // <1>

  Multiplier(int multiplier) {
    this.multiplier = multiplier
  }

  List multiply(List values) {
    values.collect {
      it * multiplier // <2>
    }
  }
}

class Doubler extends Multiplier {
  Doubler() { super(2) }
}

assert new Multiplier(3).multiply([1, 2, 3]) == [3, 6, 9] // <3>
assert new Doubler().multiply([1, 2, 3]) == [2, 4, 6] // <4>
----
<1> The parent class has a private field +multiplier+.
<2> It gets referenced in a closure in one of the parent class methods.
<3> When that method is called on an instance of the parent class all is well.
<4> When that method is called on an instance of a child class it results in +MissingPropertyException: No such property: multiplier for class: Doubler+!
